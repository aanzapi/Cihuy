<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stalk API Console</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-100 flex items-center justify-center p-6">
  <div class="bg-white rounded-xl shadow-lg w-full max-w-3xl p-8 border border-gray-200">
    <h1 class="text-2xl font-bold text-gray-800">Stalk API Console</h1>
    <p class="text-sm text-gray-500 mt-1">Pilih layanan, isi data, lalu jalankan API</p>

    <!-- Service -->
    <div class="mt-6">
      <label class="block text-sm font-medium text-gray-700">Service</label>
      <select id="service"
        class="mt-2 w-full rounded-lg border-gray-300 p-3 shadow-sm focus:ring-blue-500 focus:border-blue-500">
        <option value="ff">Free Fire (ID)</option>
        <option value="tiktok">TikTok (Username)</option>
        <option value="roblox">Roblox (Username)</option>
      </select>
    </div>

    <!-- Input -->
    <div class="mt-6">
      <label id="inputLabel" class="block text-sm font-medium text-gray-700">Masukkan ID Free Fire</label>
      <input id="inputValue" type="text" placeholder="contoh: 123456789"
        class="mt-2 w-full rounded-lg border-gray-300 p-3 shadow-sm focus:ring-blue-500 focus:border-blue-500" />
    </div>

    <!-- Buttons -->
    <div class="flex justify-end gap-3 mt-6">
      <button onclick="resetForm()"
        class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 font-medium hover:bg-gray-300 transition">
        Reset
      </button>
      <button onclick="callApi()"
        class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium shadow hover:bg-blue-700 transition">
        Call API
      </button>
    </div>

    <!-- Response -->
    <div class="mt-8">
      <div class="flex justify-between items-center mb-2">
        <h2 class="text-lg font-semibold text-gray-800">Response</h2>
        <button id="copyBtn" onclick="copyResponse()"
          class="text-sm px-3 py-1 rounded-md bg-gray-800 text-white hover:bg-black transition">
          Salin
        </button>
      </div>
      <pre id="response"
        class="min-h-[180px] max-h-[400px] overflow-auto bg-gray-900 text-green-300 text-sm p-4 rounded-lg font-mono">
Belum ada response...
      </pre>
    </div>
  </div>

  <script>
    const serviceEl = document.getElementById("service");
    const inputLabel = document.getElementById("inputLabel");
    const inputValue = document.getElementById("inputValue");
    const responseEl = document.getElementById("response");
    const copyBtn = document.getElementById("copyBtn");

    const ENDPOINTS = {
      ff: "https://api.sxtream.xyz/stalk/ffstalk",
      tiktok: "https://api.sxtream.xyz/stalk/tiktokstalk",
      roblox: "https://api.sxtream.xyz/stalk/roblox"
    };

    // Ubah label sesuai service
    serviceEl.addEventListener("change", () => {
      if (serviceEl.value === "ff") {
        inputLabel.textContent = "Masukkan ID Free Fire";
        inputValue.placeholder = "contoh: 123456789";
      } else if (serviceEl.value === "tiktok") {
        inputLabel.textContent = "Masukkan Username TikTok";
        inputValue.placeholder = "contoh: tiktokuser";
      } else if (serviceEl.value === "roblox") {
        inputLabel.textContent = "Masukkan Username Roblox";
        inputValue.placeholder = "contoh: robloxuser";
      }
    });

    async function callApi() {
      const service = serviceEl.value;
      const input = inputValue.value.trim();
      let url = ENDPOINTS[service];

      if (!input) {
        responseEl.textContent = "❌ Harap isi input terlebih dahulu!";
        return;
      }

      if (service === "ff") url += `?id=${encodeURIComponent(input)}`;
      if (service === "tiktok") url += `?username=${encodeURIComponent(input)}`;
      if (service === "roblox") url += `?username=${encodeURIComponent(input)}`;

      responseEl.textContent = "⏳ Loading...";

      try {
        const res = await fetch(url);
        const type = res.headers.get("content-type") || "";
        let data;
        if (type.includes("application/json")) data = await res.json();
        else data = await res.text();

        if (!res.ok) {
          responseEl.textContent = `❌ Error ${res.status}\n${JSON.stringify(data, null, 2)}`;
        } else {
          responseEl.textContent = JSON.stringify(data, null, 2);
        }
      } catch (err) {
        responseEl.textContent = "⚠️ Fetch error: " + err.message;
      }
    }

    function resetForm() {
      inputValue.value = "";
      responseEl.textContent = "Belum ada response...";
    }

    function copyResponse() {
      const text = responseEl.textContent;
      navigator.clipboard.writeText(text).then(() => {
        copyBtn.textContent = "✔ Disalin";
        setTimeout(() => (copyBtn.textContent = "Salin"), 1500);
      });
    }
  </script>
</body>
</html>
